<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Processing PDF</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 flex items-center justify-center min-h-screen">
    <div class="bg-white p-8 rounded-lg shadow-md max-w-md w-full text-center">
        <div class="animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto mb-4"></div>
        <h2 class="text-2xl font-bold text-gray-800 mb-2">Analyzing PDF...</h2>
        <p class="text-gray-600 mb-6">We are running OCR and extracting voter details. This may take a minute depending on the number of pages.</p>
        
        <div class="bg-blue-50 p-4 rounded text-sm text-blue-700">
            Job ID: <span class="font-mono">{{ file_id }}</span>
        </div>

        <script>
            // Simple poller: Check status every 3 seconds
            async function checkStatus() {
                const response = await fetch('/status/{{ file_id }}');
                const data = await response.json();
                if (data.status === 'Completed') {
                    window.location.href = '/processed/{{ file_id }}';
                }
            }
            setInterval(checkStatus, 3000);
        </script>
    </div>
</body>
</html> -->
<!-- 
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Processing PDF...</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 flex items-center justify-center h-screen">
    <div class="text-center bg-white p-10 rounded-xl shadow-lg border">
        <div class="animate-spin rounded-full h-16 w-16 border-b-4 border-blue-600 mx-auto mb-6"></div>
        
        <h1 class="text-2xl font-bold text-gray-800 mb-2">Analyzing Voter List...</h1>
        <p class="text-gray-500 mb-6">This may take a minute depending on the number of pages.</p>
        
        <div id="status-badge" class="px-4 py-2 bg-blue-100 text-blue-700 rounded-full text-sm font-semibold inline-block">
            Status: Initializing...
        </div>
    </div>

    <script>
        const fileId = "{{ file_id }}";
        
        async function checkStatus() {
            try {
                const response = await fetch(`/status/${fileId}`);
                const data = await response.json();
                
                document.getElementById('status-badge').innerText = `Status: ${data.status}`;

                if (data.status === "Completed") {
                    // Success! Redirect to the page with the table
                    window.location.href = `/processed/${fileId}`;
                } else if (data.status.startsWith("Error")) {
                    alert("Extraction failed: " + data.status);
                    window.location.href = "/";
                } else {
                    // Not done yet, check again in 2 seconds
                    setTimeout(checkStatus, 2000);
                }
            } catch (err) {
                console.error("Status check failed", err);
                setTimeout(checkStatus, 5000); // Retry after 5s if server is busy
            }
        }

        // Start polling
        checkStatus();
    </script>
</body>
</html> -->


<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Processing PDF - Voter OCR Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes pulse-soft {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        .animate-pulse-soft {
            animation: pulse-soft 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
    </style>
</head>
<body class="bg-gray-50 flex items-center justify-center min-h-screen p-6 font-sans">
    
    <div class="max-w-md w-full">
        <div class="bg-white p-10 rounded-3xl shadow-2xl border border-gray-100 text-center relative overflow-hidden">
            <div class="absolute top-0 left-0 w-full h-2 bg-gray-100">
                <div id="progress-bar" class="h-full bg-blue-600 transition-all duration-500 ease-out" style="width: 10%"></div>
            </div>

            <div class="relative inline-block mb-8">
                <div class="animate-spin rounded-full h-24 w-24 border-t-4 border-b-4 border-blue-600 mx-auto"></div>
                <div class="absolute inset-0 flex items-center justify-center">
                    <svg class="w-10 h-10 text-blue-600 animate-pulse-soft" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                    </svg>
                </div>
            </div>

            <h1 class="text-3xl font-black text-gray-900 mb-3 tracking-tight">Analyzing PDF</h1>
            <p class="text-gray-500 text-sm mb-8 leading-relaxed">
                Our AI is scanning voter boxes, extracting names, and verifying EPIC IDs. This usually takes <span class="font-bold text-gray-700">30-60 seconds</span>.
            </p>

            <div class="space-y-4 text-left mb-8">
                <div id="step-upload" class="flex items-center gap-3 transition-opacity duration-300">
                    <div class="step-icon w-6 h-6 rounded-full bg-green-100 flex items-center justify-center">
                        <svg class="w-4 h-4 text-green-600" fill="currentColor" viewBox="0 0 20 20"><path d="M16.707 5.293l-9.414 9.414-4.293-4.293 1.414-1.414 2.879 2.879 8-8 1.414 1.414z"/></svg>
                    </div>
                    <span class="text-sm font-bold text-gray-700">File Uploaded</span>
                </div>
                
                <div id="step-process" class="flex items-center gap-3 transition-opacity duration-300">
                    <div id="process-icon" class="step-icon w-6 h-6 rounded-full bg-blue-100 flex items-center justify-center">
                        <div class="w-2 h-2 bg-blue-600 rounded-full animate-ping"></div>
                    </div>
                    <span id="process-text" class="text-sm font-bold text-blue-600">Extracting Records...</span>
                </div>
            </div>

            <div id="status-badge" class="inline-flex items-center px-4 py-2 bg-blue-50 text-blue-700 rounded-xl text-xs font-black uppercase tracking-widest border border-blue-100">
                Current Task: Initializing
            </div>
        </div>

        <p class="text-center mt-6 text-xs text-gray-400 font-medium">
            Please do not refresh or close this tab.
        </p>
    </div>

    <script>
        const fileId = "{{ file_id }}";
        const progressBar = document.getElementById('progress-bar');
        const statusBadge = document.getElementById('status-badge');
        const processText = document.getElementById('process-text');
        const processIcon = document.getElementById('process-icon');
        
        async function checkStatus() {
            try {
                const response = await fetch(`/status/${fileId}`);
                const data = await response.json();
                const status = data.status;
                
                statusBadge.innerText = `Current Task: ${status}`;

                // Simple Logic to move progress bar based on keywords
                if (status.includes("Extracting") || status.includes("OCR")) {
                    progressBar.style.width = "50%";
                } else if (status.includes("Saving") || status.includes("Finalizing")) {
                    progressBar.style.width = "85%";
                }

                if (status === "Completed") {
                    progressBar.style.width = "100%";
                    processText.innerText = "Processing Complete!";
                    processText.classList.replace('text-blue-600', 'text-green-600');
                    processIcon.innerHTML = `<svg class="w-4 h-4 text-green-600" fill="currentColor" viewBox="0 0 20 20"><path d="M16.707 5.293l-9.414 9.414-4.293-4.293 1.414-1.414 2.879 2.879 8-8 1.414 1.414z"/></svg>`;
                    processIcon.classList.replace('bg-blue-100', 'bg-green-100');
                    
                    setTimeout(() => {
                        window.location.href = `/processed/${fileId}`;
                    }, 800);
                } else if (status.startsWith("Error")) {
                    alert("Extraction failed: " + status);
                    window.location.href = "/";
                } else {
                    setTimeout(checkStatus, 2000);
                }
            } catch (err) {
                console.error("Status check failed", err);
                setTimeout(checkStatus, 5000);
            }
        }

        checkStatus();
    </script>
</body>
</html> -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Processing PDF | Voter OCR Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes pulse-soft {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(0.95); }
        }
        .animate-pulse-soft {
            animation: pulse-soft 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        /* Custom neon glow for the progress bar */
        .glow-bar {
            box-shadow: 0 0 15px rgba(139, 92, 246, 0.5);
        }
        /* ========== ROOT & BASE ========== */

*,
*::before,
*::after {
  box-sizing: border-box;
}

html,
body {
  margin: 0;
  padding: 0;
  min-height: 100%;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  background: #020617;
  color: #e5e7eb;
}

body {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 1.5rem;
}

/* ========== BACKGROUND GLOW ========== */

body::before {
  content: "";
  position: fixed;
  inset: 0;
  background: radial-gradient(circle at center, rgba(124, 58, 237, 0.12), transparent 60%);
  filter: blur(120px);
  pointer-events: none;
}

/* ========== CARD CONTAINER ========== */

.processing-wrapper {
  max-width: 28rem;
  width: 100%;
  position: relative;
  z-index: 1;
}

.processing-card {
  background: #0b1120;
  padding: 2.5rem;
  border-radius: 2.5rem;
  border: 1px solid #1e293b;
  box-shadow: 0 25px 60px rgba(0, 0, 0, 0.6);
  text-align: center;
  position: relative;
  overflow: hidden;
}

/* ========== PROGRESS BAR ========== */

.progress-shell {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 6px;
  background: #1e293b;
}

#progress-bar {
  height: 100%;
  width: 10%;
  background: linear-gradient(90deg, #6366f1, #8b5cf6);
  transition: width 0.7s ease-in-out;
  box-shadow: 0 0 18px rgba(139, 92, 246, 0.6);
}

/* ========== SPINNER ========== */

.spinner-shell {
  position: relative;
  display: inline-block;
  margin-bottom: 2rem;
}

.spinner-ring {
  width: 7rem;
  height: 7rem;
  border-radius: 50%;
  border: 2px solid transparent;
  border-top-color: rgba(139, 92, 246, 0.3);
  border-bottom-color: rgba(139, 92, 246, 0.3);
  border-left-color: #8b5cf6;
  animation: spin 1s linear infinite;
}

.spinner-icon {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  color: #a78bfa;
  animation: pulse 2s infinite;
}

@keyframes spin {
  to {
    transform: rotate(360deg);
  }
}

@keyframes pulse {
  0%, 100% {
    opacity: 1;
  }
  50% {
    opacity: 0.5;
  }
}

/* ========== TEXT ========== */

.processing-title {
  font-size: 1.9rem;
  font-weight: 900;
  margin-bottom: 0.75rem;
  color: #ffffff;
}

.processing-desc {
  font-size: 0.85rem;
  color: #94a3b8;
  line-height: 1.6;
  margin-bottom: 2.5rem;
}

.processing-desc strong {
  color: #e5e7eb;
}

/* ========== STEPS ========== */

.steps-box {
  background: rgba(2, 6, 23, 0.6);
  border: 1px solid rgba(30, 41, 59, 0.6);
  padding: 1.5rem;
  border-radius: 1.5rem;
  margin-bottom: 2.5rem;
  text-align: left;
}

.step {
  display: flex;
  align-items: center;
  gap: 1rem;
}

.step + .step {
  margin-top: 1rem;
}

.step-icon {
  width: 24px;
  height: 24px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
}

.step-done {
  background: rgba(16, 185, 129, 0.2);
  border: 1px solid rgba(16, 185, 129, 0.4);
  color: #34d399;
}

.step-active {
  background: rgba(139, 92, 246, 0.2);
  border: 1px solid rgba(139, 92, 246, 0.4);
}

.step-active::after {
  content: "";
  width: 6px;
  height: 6px;
  background: #a78bfa;
  border-radius: 50%;
  animation: ping 1.2s infinite;
}

@keyframes ping {
  0% {
    transform: scale(1);
    opacity: 1;
  }
  75%, 100% {
    transform: scale(2.5);
    opacity: 0;
  }
}

.step-text {
  font-size: 0.85rem;
  font-weight: 700;
}

.step-text-muted {
  color: #cbd5f5;
}

.step-text-active {
  color: #a78bfa;
}

/* ========== STATUS BADGE ========== */

#status-badge {
  display: inline-flex;
  align-items: center;
  padding: 0.6rem 1.3rem;
  font-size: 0.65rem;
  font-weight: 900;
  letter-spacing: 0.2em;
  text-transform: uppercase;
  color: #94a3b8;
  background: #020617;
  border-radius: 0.9rem;
  border: 1px solid #1e293b;
}

/* ========== FOOTER NOTE ========== */

.processing-footer {
  text-align: center;
  margin-top: 2rem;
  font-size: 0.7rem;
  color: #64748b;
}

.processing-footer span {
  display: inline-block;
  animation: bounce 1.5s infinite;
}

@keyframes bounce {
  0%, 100% {
    transform: translateY(0);
  }
  50% {
    transform: translateY(-4px);
  }
}
body {
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 100vh;
  padding: 1.5rem;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  background: radial-gradient(circle at top left, #1d283a, #020617);
}
    </style>
</head>
<body class="bg-slate-950 flex items-center justify-center min-h-screen p-6 font-sans">
    
    <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-96 h-96 bg-violet-600/10 rounded-full blur-[120px] pointer-events-none"></div>

    <div class="max-w-md w-full relative z-10">
        <div class="bg-slate-900 p-10 rounded-[2.5rem] shadow-2xl border border-slate-800 text-center relative overflow-hidden">
            
            <div class="absolute top-0 left-0 w-full h-1.5 bg-slate-800">
                <div id="progress-bar" class="h-full bg-violet-500 glow-bar transition-all duration-700 ease-in-out" style="width: 10%"></div>
            </div>

            <div class="relative inline-block mb-8">
                <div class="animate-spin rounded-full h-28 w-28 border-t-2 border-b-2 border-violet-500/30 border-l-2 border-l-violet-500 mx-auto"></div>
                <div class="absolute inset-0 flex items-center justify-center">
                    <svg class="w-12 h-12 text-violet-400 animate-pulse-soft" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                    </svg>
                </div>
            </div>

            <h1 class="text-3xl font-black text-white mb-3 tracking-tight">Analyzing PDF</h1>
            <p class="text-slate-400 text-sm mb-10 leading-relaxed px-2">
                Our System is scanning voter boxes, extracting names, and verifying IDs. This usually takes time based on the document lenght.
            </p>

            <div class="space-y-4 text-left mb-10 bg-slate-950/50 p-6 rounded-2xl border border-slate-800/50">
                <div id="step-upload" class="flex items-center gap-4">
                    <div class="step-icon w-6 h-6 rounded-full bg-emerald-500/20 flex items-center justify-center border border-emerald-500/30">
                        <svg class="w-3.5 h-3.5 text-emerald-400" fill="currentColor" viewBox="0 0 20 20"><path d="M16.707 5.293l-9.414 9.414-4.293-4.293 1.414-1.414 2.879 2.879 8-8 1.414 1.414z"/></svg>
                    </div>
                    <span class="text-sm font-bold text-slate-300">File Secured</span>
                </div>
                
                <div id="step-process" class="flex items-center gap-4">
                    <div id="process-icon" class="step-icon w-6 h-6 rounded-full bg-violet-500/20 flex items-center justify-center border border-violet-500/30">
                        <div class="w-1.5 h-1.5 bg-violet-400 rounded-full animate-ping"></div>
                    </div>
                    <span id="process-text" class="text-sm font-bold text-violet-400">Extracting Records...</span>
                </div>
            </div>

            <div id="status-badge" class="inline-flex items-center px-5 py-2.5 bg-slate-950 text-slate-400 rounded-xl text-[10px] font-black uppercase tracking-[0.2em] border border-slate-800">
                Current Task: Initializing
            </div>
        </div>

        <p class="text-center mt-8 text-xs text-slate-500 font-medium">
            <span class="inline-block animate-bounce mr-1">⚠️</span> Please do not refresh or close this tab.
        </p>
    </div>

    <script>
        const fileId = "{{ file_id }}";
        const progressBar = document.getElementById('progress-bar');
        const statusBadge = document.getElementById('status-badge');
        const processText = document.getElementById('process-text');
        const processIcon = document.getElementById('process-icon');
        
        async function checkStatus() {
            try {
                const response = await fetch(`/status/${fileId}`);
                const data = await response.json();
                const status = data.status;
                
                statusBadge.innerText = `Current Task: ${status}`;

                // Smooth Progress Logic
                if (status.includes("Extracting") || status.includes("OCR")) {
                    progressBar.style.width = "55%";
                } else if (status.includes("Saving") || status.includes("Finalizing")) {
                    progressBar.style.width = "90%";
                }

                if (status === "Completed") {
                    progressBar.style.width = "100%";
                    processText.innerText = "Processing Complete!";
                    processText.classList.replace('text-violet-400', 'text-emerald-400');
                    processIcon.innerHTML = `<svg class="w-3.5 h-3.5 text-emerald-400" fill="currentColor" viewBox="0 0 20 20"><path d="M16.707 5.293l-9.414 9.414-4.293-4.293 1.414-1.414 2.879 2.879 8-8 1.414 1.414z"/></svg>`;
                    processIcon.classList.replace('bg-violet-500/20', 'bg-emerald-500/20');
                    processIcon.classList.replace('border-violet-500/30', 'border-emerald-500/30');
                    
                    setTimeout(() => {
                        window.location.href = `/processed/${fileId}`;
                    }, 800);
                } else if (status.startsWith("Error")) {
                    statusBadge.classList.replace('text-slate-400', 'text-red-400');
                    statusBadge.classList.replace('border-slate-800', 'border-red-900/50');
                    alert("Extraction failed: " + status);
                    window.location.href = "/";
                } else {
                    setTimeout(checkStatus, 2000);
                }
            } catch (err) {
                console.error("Status check failed", err);
                setTimeout(checkStatus, 5000);
            }
        }

        checkStatus();
    </script>
</body>
</html>